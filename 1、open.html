<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
</head>
<body>
   <!--  <form method="POST" action="http://localhost:4010/a.php"> 
        <input type="text" name="user">
        <button type="submit">提交</button>
    </form> -->
    aaa
    <div></div>
    bbb
    <script>
        // 数据提交给服务器有两种方式，
        // 第一种是表单提交，通过表单submit触发，提交到form中action属性地址，使用的方法是method给出的
        // 这种方式有个缺陷,需要跳转页面

        // 第二种是通过ajax提交的,就不能触发submit,而是通过按钮点击,直接使用ajax发送给服务端
        // 发送到的地址就是open中的第二个参数,发送方法就是open的第一个参数
        // 不需要跳转页面,缺陷,部分内容无法进行SEO优化
        // 以上两种情况只能二选一
        // SEO

        // Method   GET/POST/PUT/DELETE
        // GET  通过地址栏后面?带入字符串,字符串格式是变量=值&变量=值的方式传递数据给服务器
        //       这种方式仅仅去服务端获取，没有单独传递数据，并且从服务端获取需要内容，这个就是GET
        //       传递给服务器的数据少，而且是明文传递，只能使用字符串，并且数据无法进行多样性嵌套
        //        如果地址是当前页面锚点是可以提交提交页面

        // POST 数据不是通过地址栏发送，通过数据握手后信道发送数据，并且会将数据转换为二进制数据发送
        //      给服务器，传送数据可以是任意复杂度数据，但是传送的数据类型，包含了字符串，二进制流其他一些格式

        // PUT DELETE

        // 使用表单提交时，是跳转页面，跳转就不需要考虑回来的问题，所以不牵扯跨域
        // 但是ajax是访问别的网站并且将数据取回，这就需要考虑跨域问题
        // var xhr=new XMLHttpRequest();
        // xhr.addEventListener("load",loadHandler);
        // open(method,url,async,userName,password);
        // method  GET/POST/PUT/DELETE
        // URL 表示发送的地址，如果是GET方式，可以在地址后面增？参数=值传递数据
         // open的第三个参数是async 异步,默认是true,默认是异步返回数据,如果设置为false,表示同步等待
            // open的第四个和第五个参数是用户名和密码,有些地址访问是需要用户名和密码
         // xhr.open("POST","http://localhost:4010/a.php");
        // 如果直接同post发送给php,php无法接收到数据
        // 设置请求头 如果前端需要通过POST发送数据给php页面,就需要写这个请求头,给nodejs服务发送POST请求时不用写
        // 这个请求头必须写在open之后,send之前
        // xhr.setRequestHeader("content-type","application/x-www-form-urlencoded")
        // xhr.send("user=xietian");



        // 1\表单提交还是ajax发送,表单不需要跨域,ajax需要考虑跨域
        // 2\使用GET还是使用POST,数据发送的形式不同,一个是地址后缀,一个是send发送
        // 3\如果使用POST,是发送给NodeJs还是发送给PHP,服务器语言不同,处理方式不同
        // 4\AJAX--->POST--->PHP  需要写请求头xhr.setRequestHeader

// _______________________________________________________________________
        // 请求本地数据  AJAX不单纯可以请求服务器数据,还可以请求本地数据

        //加载文本文件
        /* var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("GET","./a.txt");
        xhr.send();
        function loadHandler(e){
            // console.log(this.response);
            var div=document.querySelector("div");
            div.textContent=this.response;
        } */

        //   加载外部的json文件  注意只能读取,不能写入
        /* var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("GET","./config.json");
        xhr.send();
        function loadHandler(e){
            var obj=JSON.parse(this.response);
            console.log(obj.backgroundColor);
            document.documentElement.style.backgroundColor=obj.backgroundColor;
           
        } */


        // 加载外部XML文件
        // XML 是全语言共通数据
        // 缺陷是数据太大
       /*  var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("GET","./a.xml");
        xhr.send();
        function loadHandler(e){
            xml=xhr.responseXML;
            // var num=xml.getElementsByTagName("num")[0].textContent;
            var bn=xml.querySelectorAll("bk>man")[0];
            console.log(bn.getAttribute("name"));
        } */


            // 加载图片
      /*   var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("GET","./img/2-.jpg");
        xhr.send();

        function loadHandler(e){
            console.log(this.response);
        } */

/*      加载html
        var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("GET","./a.html");
        xhr.send();
        function loadHandler(e){
            // console.log(this.response);
            var div=document.querySelector("div");
            div.innerHTML=this.response;
        } */


    // ____________________________________
        // 同步和异步

       /*异步  
       var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("POST","http://localhost:4010/a.php");
        xhr.setRequestHeader("content-type","application/x-www-form-urlencoded")
        xhr.send("user=xietian");
        console.log("a");

        function loadHandler(e){
            console.log(this.response);
            console.log("b");
        }
        console.log("c"); */


        var xhr=new XMLHttpRequest();
        // xhr.addEventListener("load",loadHandler);
        // open的第三个参数是async 异步,默认是true,默认是异步返回数据,如果设置为false,表示同步等待
        // 禁止大家使用同步功能
        xhr.open("POST","http://localhost:4010/a.php",false);
        xhr.setRequestHeader("content-type","application/x-www-form-urlencoded")
        xhr.send("user=xietian");
        console.log("a");
        // 阻塞式同步,等待数据返回后,继续执行
        console.log(xhr.response);
        console.log("c");



        // ___________________________

        //请求消息 客户端发送给服务端的消息
        //响应消息 服务端发送给客户端的消息

        // 请求消息 中需要裹挟着一些说明型的数据，让服务端收到后根据这些数据比对和解析
        // 这种数据一般比请求消息更早的发到服务端，服务端就可以解析了，这种数据就是请求头
       /*  var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("POST","http://localhost:4010/a.php");
        // 在ajax中设置请求头通过xhr.setRequestHeader(请求头名，请求头值);
        // 可以写多条语句设置
        xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");
        xhr.setRequestHeader("names","xietian");
        xhr.send("user=xietian");


        function loadHandler(e){

        } */



        // 在客户端中可以设置请求头和获取响应头
        // 在服务端中可以获取请求头和设置响应头
        var xhr=new XMLHttpRequest();
        xhr.addEventListener("load",loadHandler);
        xhr.open("POST","http://localhost:8000");
        xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");
        // 这个是自定义的请求头，如果跨域时，请求头也必须设置允许跨域才可以发送
        xhr.setRequestHeader("dataType","json");
        // 设置请求头必须写在open和send之间
        xhr.send("user=xietian");

        function loadHandler(e){
            // 获取所有响应头消息
            console.log(xhr.getAllResponseHeaders());
            // 获取指定的响应头消息
            console.log(xhr.getResponseHeader("content-type"));
        }
    </script>
</body>
</html>